<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="preload" href="./assets/css/style.css" as="style">
  <link rel="stylesheet" href="./assets/css/style.css">

  <script src="./assets/js/include.js" defer></script>

  <title>Spazio X â€” Home</title>
  <link rel="icon" href="./assets/img/favicon.ico" type="image/x-icon">
  <link rel="preload"
      href="/assets/fonts/xicons.woff2"
      as="font" type="font/woff2" crossorigin>

  <link rel="stylesheet" href="/assets/css/xicons.css">
  <style>
    /* ----- Desktop/Tablet ----- */
    .flyer-container { transform: translateY(-8svh); }

    /* Cornice ridotta (200px) â€” home mantiene la sua altezza dedicata su desktop/tablet */
    .flyer-image {
      height: 200px;
      max-width: 300px;
      width: 100%;
      margin: 0 auto;
      overflow: hidden;
      position: relative;
      z-index: 1;
      box-sizing: border-box;
    }
    .flyer-image > .flyer-frame {
      height: 100%;
      border: 1px solid #000;
      background: #fafafa;
      display: flex;
      align-items: stretch;
      justify-content: center;
      overflow: hidden;
    }

    #hydra-canvas {
      width: 100%;
      height: 100%;
      display: block;
      image-rendering: crisp-edges;
    }

    .page-title { text-align: left; }

    .home-actions-top,
    .hydra-credit,
    .home-actions-bottom {
      width: 100%;
      max-width: 300px;
      margin-left: auto;
      margin-right: auto;
    }

    .hydra-credit {
      margin: 4px auto 0;
      text-align: center;
      font-size: 0.5em;
      color: #777;
      letter-spacing: 0.02em;
      position: relative;
      z-index: 2;
    }
    .hydra-credit a {
      color: #777;
      text-decoration: none;
      border-bottom: 1px dotted #aaa;
    }
    .hydra-credit a:hover {
      color: #000;
      border-color: #000;
    }

    .btn {
      display: inline-block;
      padding: 8px 14px;
      border: 1px solid #888;
      background: #f7f7f7;
      color: #333;
      text-decoration: none;
      font-size: .9em;
      cursor: pointer;
      user-select: none;
      position: relative;
      z-index: 2;
    }
    .btn:hover, .btn:focus { background:#eee; color:#000; }

    .home-actions-bottom {
      margin-top: 12px;
      display: flex;
      gap: 16px;
      justify-content: center;
      align-items: center;
      position: relative;
      z-index: 2;
    }

    details.dropdown { position: relative; display: inline-block; }
    details.dropdown > summary { list-style: none; outline: none; }
    details.dropdown > summary::-webkit-details-marker { display: none; }
    details.dropdown[open] > summary.btn { background:#eee; }

    .menu {
      position: absolute;
      top: calc(100% + 6px);
      left: 0;
      min-width: 160px;
      border: 1px solid #888;
      background: #fff;
      padding: 6px;
      z-index: 10;
      box-sizing: border-box;
      max-width: 100%;
      overflow-wrap: anywhere;
    }
    .menu a {
      display: block;
      padding: 6px 8px;
      border: 1px solid transparent;
      text-decoration: none;
      color: #333;
      font-size: .9em;
    }
    .menu a:hover { border-color:#888; background:#f7f7f7; }

    /* ----- âœ… Spazio ridotto (desktop/widescreen) ----- */
    @media (min-width: 481px) {
      .hydra-credit {
        margin: 6px auto 0 !important;
        padding-bottom: 6px !important; /* spazio ridotto */
      }
      .home-actions-bottom {
        margin-top: 10px !important; /* leggermente piÃ¹ compatto */
      }
    }

    /* ----- Mobile (â‰¤480px): invariato ----- */
    @media (max-width: 480px) {
      html, body { overflow-x: hidden; width: 100%; max-width: 100%; }

      .flyer-container { transform: none; margin-top: -8svh; }

      .flyer-image {
        width: min(300px, calc(100vw - 2*16px - 2px));
        max-width: none;
        aspect-ratio: 4 / 5;
        height: auto;
        border: 1px solid #000;
        background: #fafafa;
        overflow: hidden;
        position: relative;
        z-index: 1;
      }
      .flyer-image > .flyer-frame {
        border: 0;
        background: transparent;
        display: flex;
        align-items: stretch;
        justify-content: stretch;
        height: 100%;
        box-sizing: border-box;
      }
      #hydra-canvas {
        width: 100%;
        height: 100%;
        display: block;
      }

      .home-actions-top,
      .hydra-credit,
      .home-actions-bottom {
        width: min(300px, calc(100vw - 2*16px - 2px));
        max-width: none;
        margin-left: auto;
        margin-right: auto;
        position: relative;
        z-index: 2;
      }

      .page-title { padding: 0 16px; }
      .menu { max-width: calc(100vw - 2*16px); }
    }
  </style>
</head>

<body class="is-home">
  <div id="header"></div>

  <h1 class="page-title">Spazio <b class="xi-logox fa-4x"></b></h1>

  <main class="flyer-container">
    <div class="flyer-block">

      <!-- Pulsante download -->
      <div class="home-actions-top">
        <a class="btn btn-download" 
          href="https://raw.githubusercontent.com/xspazioxspaziox/xspazioxspaziox.github.io/04b8174bf6b5b60d87408ac2fdad85b869284ef4/spazio-x-dicembre-2025.pdf" 
          download>
          Scarica il programma di dicembre
        </a>
      </div>

      <!-- Cornice con Hydra -->
      <div class="flyer-image">
        <div class="flyer-frame">
          <canvas id="hydra-canvas"></canvas>
        </div>
      </div>

      <!-- Credito Hydra -->
      <div class="hydra-credit">
        *visual generated with
        <a href="https://hydra.ojack.xyz/" target="_blank">Hydra</a> by O. Jack -
        <a href="/assets/js/hydra.js" target="_blank">code</a>
      </div>

      <!-- Bottoni -->
      <div class="home-actions-bottom">
        <details class="dropdown">
          <summary class="btn btn-eventi">prossimi eventi</summary>
          <div class="menu">
            <a href="eventi/2025/06-12-flyer/">06.12.25</a>
            <a href="eventi/2025/13-12-flyer/">13.12.25</a>
          </div>
        </details>

        <details class="dropdown">
          <summary class="btn btn-archivio">index</summary>
          <div class="menu">
            <a href="eventi/">/eventi</a>
            <a href="artisti/">/artisti</a>
          </div>
        </details>

        <button id="randomBtn" class="btn btn-random" type="button">ðŸ”Š</button>
      </div>

    </div>
  </main>

  <div id="footer"></div>

  <script src="https://cdn.jsdelivr.net/npm/hydra-synth/dist/hydra-synth.js"></script>
  <script>
    const hydraCanvas = document.getElementById('hydra-canvas');
    const hydra = new Hydra({ canvas: hydraCanvas, detectAudio: false });

    osc(4,.02,0)
      .rotate(.2,1).scale(8,.6)
      .modulateScrollX(noise(.2,.02))
      .modulateScrollY(noise(.4,.02))
      .modulate(noise(200,.2))
      .repeat(6,4)
      .rotate(.2,.2)
      .scrollY(()=>mouse.x/3000)
      .diff(gradient(.02))
      .modulate(src(o0))
      .diff(shape([80],.8))
      .scrollY(80,.2)
      .repeat(()=>mouse.y/220,()=>mouse.x/400)
      .modulate(src(o0).scrollX(2))
      .diff(noise(1))
      .out(o0);

    const sounds = {
      download: new Audio('/assets/sfx/download.mp3'),
      eventi: new Audio('/assets/sfx/eventi.mp3'),
      archivio: new Audio('/assets/sfx/archivio.mp3'),
      random: new Audio('/assets/sfx/random.mp3'),
    };
    Object.values(sounds).forEach(a => { a.preload = 'auto'; a.volume = 0.8; });

    function playSound(key) {
      const base = sounds[key];
      if (!base) return;
      const clone = base.cloneNode(true);
      clone.play().catch(()=>{});
    }

    document.querySelector('.btn-download')?.addEventListener('click', () => playSound('download'));
    document.querySelector('.btn-eventi')?.addEventListener('click', () => playSound('eventi'));
    document.querySelector('.btn-archivio')?.addEventListener('click', () => playSound('archivio'));
    document.querySelector('.btn-random')?.addEventListener('click', () => playSound('random'));

    const RANDOM_LINKS = [
      'https://t.me/xsoundxspaziox',
    ];
    document.getElementById('randomBtn').addEventListener('click', () => {
      const url = RANDOM_LINKS[Math.floor(Math.random() * RANDOM_LINKS.length)];
      window.open(url, '_blank');
    });

    document.querySelectorAll('details.dropdown summary').forEach(s => {
      s.addEventListener('click', () => {
        const parent = s.parentElement;
        document.querySelectorAll('details.dropdown[open]').forEach(d => {
          if (d !== parent) d.removeAttribute('open');
        });
      });
    });
  </script>
</body>
</html>
