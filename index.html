<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="preload" href="./assets/css/style.css" as="style">
  <link rel="stylesheet" href="./assets/css/style.css">

  <script src="./assets/js/include.js" defer></script>

  <title>Spazio X — Home</title>
  <link rel="icon" href="./assets/img/favicon.ico" type="image/x-icon">
  <link rel="preload"
      href="/assets/fonts/xicons.woff2"
      as="font" type="font/woff2" crossorigin>

  <link rel="stylesheet" href="/assets/css/xicons.css">
  <style>
    /* Alza il blocco centrale */
    .flyer-container { transform: translateY(-8svh); }

    /* Cornice ridotta (200px) */
    .flyer-image {
      height: 200px;
      max-width: 300px;
      width: 100%;
      margin: 0 auto;
    }
    .flyer-image > .flyer-frame {
      height: 100%;
      border: 1px solid #000;
      background: #fafafa;
      display: flex;
      align-items: stretch;
      justify-content: center;
      overflow: hidden;
    }

    #hydra-canvas {
      width: 100%;
      height: 100%;
      display: block;
      image-rendering: crisp-edges;
    }

    .page-title { text-align: left; }

    .home-actions-top {
      width: 100%;
      max-width: 300px;
      margin: 0 auto 10px;
      text-align: center;
    }

    .hydra-credit {
      width: 100%;
      max-width: 300px;
      margin: 4px auto 0;
      text-align: center;
      font-size: 0.5em;
      color: #777;
      letter-spacing: 0.02em;
    }
    .hydra-credit a {
      color: #777;
      text-decoration: none;
      border-bottom: 1px dotted #aaa;
    }
    .hydra-credit a:hover {
      color: #000;
      border-color: #000;
    }

    .btn {
      display: inline-block;
      padding: 8px 14px;
      border: 1px solid #888;
      background: #f7f7f7;
      color: #333;
      text-decoration: none;
      font-size: .9em;
      cursor: pointer;
      user-select: none;
    }
    .btn:hover, .btn:focus { background:#eee; color:#000; }

    .home-actions-bottom {
      margin-top: 12px;
      display: flex;
      gap: 16px;
      justify-content: center;
      align-items: center;
    }

    details.dropdown { position: relative; display: inline-block; }
    details.dropdown > summary { list-style: none; outline: none; }
    details.dropdown > summary::-webkit-details-marker { display: none; }
    details.dropdown[open] > summary.btn { background:#eee; }

    .menu {
      position: absolute;
      top: calc(100% + 6px);
      left: 0;
      min-width: 160px;
      border: 1px solid #888;
      background: #fff;
      padding: 6px;
      z-index: 10;
      box-sizing: border-box;
    }
    .menu a {
      display: block;
      padding: 6px 8px;
      border: 1px solid transparent;
      text-decoration: none;
      color: #333;
      font-size: .9em;
    }
    .menu a:hover { border-color:#888; background:#f7f7f7; }
  </style>
</head>

<body>
  <div id="header"></div>

  <h1 class="page-title">Spazio <b class="xi-logox fa-4x"></b></h1>

  <main class="flyer-container">
    <div class="flyer-block">

      <!-- Pulsante download -->
      <div class="home-actions-top">
        <a class="btn btn-download" 
          href="https://raw.githubusercontent.com/xspazioxspaziox/xspazioxspaziox.github.io/545db9824541a67d9cfb6aff027abd2853e1a9cf/spazio-x-ottobre-2025.pdf" download>
          Scarica il programma di ottobre
        </a>
      </div>

      <!-- Cornice con Hydra -->
      <div class="flyer-image">
        <div class="flyer-frame">
          <canvas id="hydra-canvas"></canvas>
        </div>
      </div>

      <!-- Credito Hydra -->
      <div class="hydra-credit">
        *visual generated with
        <a href="https://hydra.ojack.xyz/" target="_blank">Hydra</a> by O. Jack - <a href="/assets/js/hydra.js" target="_blank">code</a>
      </div>

      <!-- Bottoni -->
      <div class="home-actions-bottom">
        <details class="dropdown">
          <summary class="btn btn-eventi">prossimi eventi</summary>
          <div class="menu">
            <a href="eventi/2025/31-08-yoga-flyer/">31.08.25</a>
            <a href="eventi/2025/27-09-xxx-flyer/">27.09.25</a>
            <a href="eventi/2025/28-09-xxx-flyer/">28.09.25</a>
          </div>
        </details>

        <details class="dropdown">
          <summary class="btn btn-archivio">index</summary>
          <div class="menu">
            <a href="eventi/">/eventi</a>
            <a href="artisti/">/artisti</a>
          </div>
        </details>

        <button id="randomBtn" class="btn btn-random" type="button">?</button>
      </div>

    </div>
  </main>

  <div id="footer"></div>

  <script src="https://cdn.jsdelivr.net/npm/hydra-synth/dist/hydra-synth.js"></script>
  <script>
    // === HYDRA ===
    const hydraCanvas = document.getElementById('hydra-canvas');
    const hydra = new Hydra({ canvas: hydraCanvas, detectAudio: false });

    // === codice visuals hydra, se lo cambi aggiorna anche dentro /assets/js/hydra.js ===
    osc(10, 0.08, 1)
      .modulateScale(osc(6).rotate(Math.sin(time)), .5)
      .thresh(.4)
.colorama(50)
.modulateScale(o0)
      .diff(src(o0).scale(3))
      .modulateScale(osc(1).modulateRotate(o0, .7))
      .diff(src(o0).rotate([-.02, .01, -.002, 0]).scrollY(0, [-0.006, 0].fast(0.7)))
      .out(o0);


    // === SUONI PERSONALIZZATI ===
    const sounds = {
      download: new Audio('/assets/sfx/download.mp3'),
      eventi: new Audio('/assets/sfx/eventi.mp3'),
      archivio: new Audio('/assets/sfx/archivio.mp3'),
      random: new Audio('/assets/sfx/random.mp3'),
    };

    // Imposta preload e volume
    Object.values(sounds).forEach(a => {
      a.preload = 'auto';
      a.volume = 0.8;
    });

    // Funzione per clonare e suonare (evita sovrapposizioni tagliate)
    function playSound(key) {
      const base = sounds[key];
      if (!base) return;
      const clone = base.cloneNode(true);
      clone.play().catch(()=>{});
    }

    // Collega i suoni
    document.querySelector('.btn-download')?.addEventListener('click', () => playSound('download'));
    document.querySelector('.btn-eventi')?.addEventListener('click', () => playSound('eventi'));
    document.querySelector('.btn-archivio')?.addEventListener('click', () => playSound('archivio'));
    document.querySelector('.btn-random')?.addEventListener('click', () => playSound('random'));

    // === RANDOM LINK “?” ===
    const RANDOM_LINKS = [
      '/eventi/2025/31-08-yoga-flyer/',
      '/eventi/2025/31-08-yoga-info/',
      '/eventi/',
      '/artisti/',
      '/artisti/pino-scoppon/'
    ];
    document.getElementById('randomBtn').addEventListener('click', () => {
      const url = RANDOM_LINKS[Math.floor(Math.random() * RANDOM_LINKS.length)];
      location.href = url;
    });

    // === Dropdown: chiusura automatica ===
    document.querySelectorAll('details.dropdown summary').forEach(s => {
      s.addEventListener('click', () => {
        const parent = s.parentElement;
        document.querySelectorAll('details.dropdown[open]').forEach(d => {
          if (d !== parent) d.removeAttribute('open');
        });
      });
    });
  </script>
</body>
</html>
